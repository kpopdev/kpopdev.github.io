<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>بهترین DNS ایرانی ۱۴۰۴–۱۴۰۵ | hannibot.ir</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 1000px; margin: 30px auto; padding: 0 15px; line-height: 1.6; background: #f9f9f9; color: #222; }
    h1, h2 { color: #c62828; text-align: center; }
    table { width: 100%; border-collapse: collapse; margin: 30px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.08); }
    th, td { border: 1px solid #ddd; padding: 14px; text-align: right; }
    th { background: #c62828; color: white; }
    tr:nth-child(even) { background: #f8f8f8; }
    .copy-btn { padding: 6px 12px; margin: 0 5px; background: #1976d2; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 0.95em; }
    .copy-btn:hover { background: #1565c0; }
    .copy-btn.copied { background: #388e3c !important; }
    .loading { text-align: center; font-size: 1.2em; color: #555; margin: 50px 0; }
    .error { color: #d32f2f; text-align: center; }
    .tip { background: #fff8e1; padding: 16px; border-radius: 8px; margin: 20px 0; border-right: 5px solid #ffb300; }
  </style>
</head>
<body>

<h1>بهترین DNSهای ایرانی (به‌روزرسانی خودکار)</h1>

<div class="tip">
  <strong>نکته:</strong> بهترین DNS بسته به ISP شما (ایرانسل، همراه اول، مخابرات ...) فرق می‌کنه. حتماً تست کنید.
</div>

<h2>لیست DNSها (کلیک برای کپی)</h2>

<div id="loading" class="loading">در حال بارگذاری DNSها...</div>
<div id="error" class="error" style="display:none;"></div>

<table id="dnsTable" style="display:none;">
  <thead>
    <tr>
      <th>نام سرویس</th>
      <th>DNS اصلی</th>
      <th>DNS ثانویه</th>
      <th>بهترین کاربرد</th>
      <th>کپی</th>
    </tr>
  </thead>
  <tbody id="dnsBody"></tbody>
</table>

<footer style="text-align:center; margin-top:60px; color:#777;">
  آخرین به‌روزرسانی: با هر Commit فایل dns-list.json • ساخته شده توسط hannibot.ir
</footer>

<script>
async function loadDNS() {
  const loading = document.getElementById('loading');
  const errorDiv = document.getElementById('error');
  const table = document.getElementById('dnsTable');
  const tbody = document.getElementById('dnsBody');

  try {
    // مسیر فایل – اگر فایل در ریشه است: 'dns-list.json'
    // اگر در فولدر data است: 'data/dns-list.json'
    const response = await fetch('dns-list.json');

    if (!response.ok) throw new Error('فایل پیدا نشد یا خطا در بارگذاری');

    const data = await response.json();

    tbody.innerHTML = ''; // پاک کردن قبلی

    data.forEach(item => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${item.service || '—'}</td>
        <td>${item.primary || '—'}</td>
        <td>${item.secondary || '—'}</td>
        <td>${item.best_for || '—'}</td>
        <td>
          ${item.primary ? `<button class="copy-btn" data-clipboard="${item.primary}">کپی اصلی</button>` : ''}
          ${item.secondary ? `<button class="copy-btn" data-clipboard="${item.secondary}">کپی ثانویه</button>` : ''}
        </td>
      `;
      tbody.appendChild(row);
    });

    loading.style.display = 'none';
    table.style.display = 'table';
  } catch (err) {
    loading.style.display = 'none';
    errorDiv.style.display = 'block';
    errorDiv.textContent = 'خطا در بارگذاری لیست DNS: ' + err.message + ' (فایل dns-list.json را چک کنید)';
  }
}

// کپی کردن
document.addEventListener('click', e => {
  if (e.target.classList.contains('copy-btn')) {
    const text = e.target.getAttribute('data-clipboard');
    navigator.clipboard.writeText(text).then(() => {
      const original = e.target.textContent;
      e.target.textContent = 'کپی شد!';
      e.target.classList.add('copied');
      setTimeout(() => {
        e.target.textContent = original;
        e.target.classList.remove('copied');
      }, 1800);
    }).catch(() => alert('کپی نشد – دستی کپی کنید'));
  }
});

// بارگذاری موقع باز شدن صفحه
loadDNS();
</script>

</body>
</html>
